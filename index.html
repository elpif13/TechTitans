
<!DOCTYPE html>
<html>
<head>
  <title>Aircraft Locations on Google Maps</title>
  <style>
    #map {
      height: 400px;
      width: 100%;
    }
  </style>
</head>
<body>
<h1>Aircraft Locations on Google Maps</h1>
<div id="map"></div>

<script>
  // Initialize the map
  function initMap() {
    var map = new google.maps.Map(document.getElementById('map'), {
      zoom: 4,
      center: {lat: 26.8132, lng: 75.3153} // Default center (India)
    });

    // Fetch data and process
    function fetchDataAndProcess() {
      fetch('aircraft_data.json')
              .then(response => response.json())
              .then(data => {
                // Clear existing markers
                markers.forEach(marker => {
                  marker.setMap(null);
                });
                markers = [];

                // Process each aircraft data and create markers with custom icon and info window
                data.forEach(aircraft => {
                  var icon = {
                    url: 'https://maps.google.com/mapfiles/kml/shapes/airports.png', // Publicly available plane icon
                    scaledSize: new google.maps.Size(40, 40), // Size of the icon
                    origin: new google.maps.Point(0, 0), // Position of the icon's origin (top left corner)
                    anchor: new google.maps.Point(20, 20) // Anchor point of the icon (center)
                  };

                  // Calculate rotation angle based on true track
                  var rotationAngle = aircraft.true_track;

                  // Create a custom marker with a rotated icon
                  var marker = new google.maps.Marker({
                    position: {lat: aircraft.latitude, lng: aircraft.longitude},
                    map: map,
                    title: aircraft.callsign,
                    icon: {
                      url: 'https://images.vexels.com/media/users/3/242810/isolated/preview/faf4f5ad02d6d68cfeafa44e1b57649a-plane-semi-flat.png', // Arrow icon
                      scaledSize: new google.maps.Size(40, 40), // Size of the icon
                      rotation: rotationAngle // Rotation angle
                    }
                  });

                  // Create info window content
                  var contentString = `
                    <div>
                        <h2>${aircraft.callsign}</h2>
                        <p><b>Origin Country:</b> ${aircraft.origin_country}</p>
                        <p><b>Velocity:</b> ${aircraft.velocity} m/s</p>
                        <p><b>True Track:</b> ${aircraft.true_track}Â°</p>
                        <p><b>Vertical Rate:</b> ${aircraft.vertical_rate} m/s</p>
                    </div>
                `;

                  var infoWindow = new google.maps.InfoWindow({
                    content: contentString
                  });

                  // Add click event listener to marker to open info window
                  marker.addListener('click', function() {
                    infoWindow.open(map, marker);
                  });

                  // Push marker to markers array
                  markers.push(marker);
                });
              })
              .catch(error => {
                console.error('Error fetching aircraft data:', error);
              });
    }

    // Array to store markers
    var markers = [];

    // Fetch data and process initially
    fetchDataAndProcess();

    // Fetch data and process every 30 seconds
    setInterval(fetchDataAndProcess, 30000);
  }
</script>
<!-- Include the Google Maps API with your API key -->
<script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCOM8r6gvpx3MvdvALICZ6FMbcU_DzeJI4&callback=initMap">
</script>
</body>
</html>
